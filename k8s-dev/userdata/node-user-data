#! /bin/bash
mkdir -p /var/cache/kubernetes-install
cd /var/cache/kubernetes-install
cat > kube_env.yaml << __EOF_KUBE_ENV_YAML
ENV_TIMESTAMP: '2016-05-06T18:15:38+0000'
INSTANCE_PREFIX: 'kubernetes'
NODE_INSTANCE_PREFIX: 'kubernetes-minion'
CLUSTER_IP_RANGE: '10.244.0.0/16'
SERVER_BINARY_TAR_URL: 'https://s3.amazonaws.com/kubernetes-staging-1f8388770186e82b07ada78a3d29b1db/devel/kubernetes-server-linux-amd64.tar.gz'
SERVER_BINARY_TAR_HASH: '86c63983a1a1da3f1ec76e1914964e8a42fba244'
SALT_TAR_URL: 'https://s3.amazonaws.com/kubernetes-staging-1f8388770186e82b07ada78a3d29b1db/devel/kubernetes-salt.tar.gz'
SALT_TAR_HASH: '246074805c38dad8774a027a97201cf2bb33b1d4'
SERVICE_CLUSTER_IP_RANGE: '10.0.0.0/16'
KUBERNETES_MASTER_NAME: 'kubernetes-master'
ALLOCATE_NODE_CIDRS: 'true'
ENABLE_CLUSTER_MONITORING: 'influxdb'
ENABLE_L7_LOADBALANCING: 'none'
ENABLE_CLUSTER_LOGGING: 'true'
ENABLE_CLUSTER_UI: 'true'
ENABLE_NODE_LOGGING: 'true'
LOGGING_DESTINATION: 'elasticsearch'
ELASTICSEARCH_LOGGING_REPLICAS: '1'
ENABLE_CLUSTER_DNS: 'true'
ENABLE_CLUSTER_REGISTRY: 'false'
CLUSTER_REGISTRY_DISK: ''
CLUSTER_REGISTRY_DISK_SIZE: ''
DNS_REPLICAS: '1'
DNS_SERVER_IP: '10.0.0.10'
DNS_DOMAIN: 'cluster.local'
KUBELET_TOKEN: 'lvAIUZkjSBoanj8FNhz2MBIfDsRjjoGJ'
KUBE_PROXY_TOKEN: 'MJmB5b3RngOUFJjfdhkYnZhC2MDD8Oqs'
ADMISSION_CONTROL: 'NamespaceLifecycle,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota,PersistentVolumeLabel'
MASTER_IP_RANGE: '10.246.0.0/24'
RUNTIME_CONFIG: ''
CA_CERT: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURYekNDQWtlZ0F3SUJBZ0lKQUxEL0tLYUs2dzMvTUEwR0NTcUdTSWIzRFFFQkN3VUFNQ1F4SWpBZ0JnTlYKQkFNVUdUVXlMakl3TWk0eU1qWXVNVGN6UURFME5qSTFOVGcwT0RZd0hoY05NVFl3TlRBMk1UZ3hORFEyV2hjTgpNall3TlRBME1UZ3hORFEyV2pBa01TSXdJQVlEVlFRREZCazFNaTR5TURJdU1qSTJMakUzTTBBeE5EWXlOVFU0Ck5EZzJNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTBGNHRzNjA1YW13bkJFOEsKVG9TUHdiTUZSUldQdUtoc21WTDIveUp3UUxRM3dQNWNXN1dzc3pOcFhES2NXYUprT2d4OG9LN0VRY28zaVBlQQpNZ1NNRkNMMHJaa3VZcW9aRWkvT3FvUmRrM05tNGxSbGNXN0NpTWorZjQ5Qk9Wd2NDcHBjb1VYbkUyTGgydlpnCktLMERDaGtUOUVjKzVtMndKNDB2dmNWUW44UmZwUStVY05Db2pGanVhRHpSUnQyWjhtMVM1aHJGTGpNV2E3ck0KWC8yV3hYekozSXN4bFBMRTB5QnhjOFFHR1Bqb3NLZUZRVW1MbTlYQ2JNbEpCQXNldkJVV3RZNUtJRFZpNHRVQQpMUFdlRGlZYjRtRGFITmhWb0xodVRDSndMWlUvZGJ5NjlCajNYdkhYNjk2WlRDeUV6a2RWSjFwZ0RjdXlaRXhICnpkUkxIUUlEQVFBQm80R1RNSUdRTUIwR0ExVWREZ1FXQkJUc2RMN280MUcweXVJZWhOeWdLRVlEbkRDWGV6QlUKQmdOVkhTTUVUVEJMZ0JUc2RMN280MUcweXVJZWhOeWdLRVlEbkRDWGU2RW9wQ1l3SkRFaU1DQUdBMVVFQXhRWgpOVEl1TWpBeUxqSXlOaTR4TnpOQU1UUTJNalUxT0RRNE5vSUpBTEQvS0thSzZ3My9NQXdHQTFVZEV3UUZNQU1CCkFmOHdDd1lEVlIwUEJBUURBZ0VHTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDWHVNbW9wRkV6MFpXTkJpc1YKS3VZNXZNUEhUNVh4U29pbXJJQk9tSjNGMk1odmF2WHNURVJYY1NKbUhxeUVXejdvellkZ2NyRWM2K0dBVUx3dwpaV1BrOTdZUkxHTUxGbjJMZTdBbFFyV1RxQVFsRkhDQWxKK0o0MnJ5SFIwdkE0dU1mYlczQ1ZuVmlodGJnekVRCnhUTm1GMUdTMXl4bFcxcjdJT1NTbEdKTlNEVUtzMDdaTVFvbjFIUC9oOEpZUE9TZVpVb2JaZGhZQ3FTYS85MXcKS2YrU3RheG9wSWM3T2lJR0YzU0UxUWY2dG5RVTVZdUVjdWxyMW5vQkF4L2JaRW4yckUrNWtrYWtjRUlSUUNCNgpQRnJLNWRCS1dkR0QyQkNLZTMzQ1V3KzJzWXNWakpDSjVSbTJjYWpEQmdTK1RVU2dvN3lyR3gxN2Zhb0RORTRUCkUyc0EKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo='
KUBELET_CERT: 'Q2VydGlmaWNhdGU6CiAgICBEYXRhOgogICAgICAgIFZlcnNpb246IDMgKDB4MikKICAgICAgICBTZXJpYWwgTnVtYmVyOiAyICgweDIpCiAgICBTaWduYXR1cmUgQWxnb3JpdGhtOiBzaGEyNTZXaXRoUlNBRW5jcnlwdGlvbgogICAgICAgIElzc3VlcjogQ049NTIuMjAyLjIyNi4xNzNAMTQ2MjU1ODQ4NgogICAgICAgIFZhbGlkaXR5CiAgICAgICAgICAgIE5vdCBCZWZvcmU6IE1heSAgNiAxODoxNDo0NiAyMDE2IEdNVAogICAgICAgICAgICBOb3QgQWZ0ZXIgOiBNYXkgIDQgMTg6MTQ6NDYgMjAyNiBHTVQKICAgICAgICBTdWJqZWN0OiBDTj1rdWJlbGV0CiAgICAgICAgU3ViamVjdCBQdWJsaWMgS2V5IEluZm86CiAgICAgICAgICAgIFB1YmxpYyBLZXkgQWxnb3JpdGhtOiByc2FFbmNyeXB0aW9uCiAgICAgICAgICAgICAgICBQdWJsaWMtS2V5OiAoMjA0OCBiaXQpCiAgICAgICAgICAgICAgICBNb2R1bHVzOgogICAgICAgICAgICAgICAgICAgIDAwOmQyOjM1OjY4OjRkOjJmOjcwOjdmOmU3OmU0OmJmOjUyOmIwOjYxOmFlOgogICAgICAgICAgICAgICAgICAgIGYyOmVmOmFhOjU4Ojg4OjA0OjZhOmFmOmIyOjZhOjA5OjNhOjBmOjZkOmIyOgogICAgICAgICAgICAgICAgICAgIDkzOmIzOmZhOjBhOjU2OmQ5OjdjOmEzOjBkOjQ0OjgwOmUxOmU3OjExOjg4OgogICAgICAgICAgICAgICAgICAgIDA3OmE0OjNhOmM0OjkwOmI1OmEyOjYyOjg0OmM1OmNmOmE2OmVhOjJmOjI3OgogICAgICAgICAgICAgICAgICAgIDFiOjU3OmFiOmFlOjgzOmNlOjhjOjNhOmI2OjdlOjBlOjA2OjhkOjQ5OjAzOgogICAgICAgICAgICAgICAgICAgIDZlOmFkOjdhOmQ0OmFiOmJhOjg5OmU0OmE4OjJlOjMwOmVlOjdmOjFmOjdiOgogICAgICAgICAgICAgICAgICAgIDFjOmE5OmJkOjcyOjk4OmFjOjU3OmI3OjQ2OmI2OmRhOjVhOmM4OmE2OjY5OgogICAgICAgICAgICAgICAgICAgIGY4OjU2OjkxOjc3OjQ4OmNmOjJhOmVjOjYwOjlmOjUxOjQ5OmEzOjA0OjY2OgogICAgICAgICAgICAgICAgICAgIGUzOmQ3Ojg2OjkyOjY1OjQ3OmQ5OjhmOmViOmU5OjA5OjZhOjE4OjI3OjEwOgogICAgICAgICAgICAgICAgICAgIDdhOjlhOjFmOmQwOjE4OjkwOjk5OmVjOjAzOjFiOmMxOjhlOmFiOjI1OjQwOgogICAgICAgICAgICAgICAgICAgIDNmOmZlOmJiOjU4OjY2OjkxOjEwOjcxOmU3OjQzOjM4OjYyOjkzOmMwOjczOgogICAgICAgICAgICAgICAgICAgIDM3OmRmOjg5Ojc2OmIzOjdkOmY2OjYxOjMxOmEwOmNjOjU4OmU4OmNhOmFiOgogICAgICAgICAgICAgICAgICAgIDE4Ojk2OjRjOmU3OmY3OjYwOmQ0OmZiOmNjOjBjOmM0OjZjOjBmOjgzOjBmOgogICAgICAgICAgICAgICAgICAgIDc3OjE1OmE1OmM5OmU4OjRhOjI2OjkyOjMyOmIzOjYzOmFlOjQwOmQ1OmQ2OgogICAgICAgICAgICAgICAgICAgIDhmOjllOmFjOmJiOjc2OjI4OmFmOjY0OjA5OjE5OmNlOjk4OjNmOmZkOjMzOgogICAgICAgICAgICAgICAgICAgIDU0OjM1OmMxOjAwOjIxOmVlOjQxOjBmOmRkOjY0OmFmOjBjOjIyOjc5OjIwOgogICAgICAgICAgICAgICAgICAgIDYxOjkwOjllOjkyOmY1OmFkOjQ0OjNlOjlmOmRkOjFkOjU5OjJlOjQyOjMyOgogICAgICAgICAgICAgICAgICAgIDQyOjQzCiAgICAgICAgICAgICAgICBFeHBvbmVudDogNjU1MzcgKDB4MTAwMDEpCiAgICAgICAgWDUwOXYzIGV4dGVuc2lvbnM6CiAgICAgICAgICAgIFg1MDl2MyBCYXNpYyBDb25zdHJhaW50czogCiAgICAgICAgICAgICAgICBDQTpGQUxTRQogICAgICAgICAgICBYNTA5djMgU3ViamVjdCBLZXkgSWRlbnRpZmllcjogCiAgICAgICAgICAgICAgICBFMzpDNzpFRDpEMjo5Nzo2NjpCNzo2RToxMTozMDo5QTo2QzpDQjoxQjo3RDoxQzpBQTo2NTo4MTo5NgogICAgICAgICAgICBYNTA5djMgQXV0aG9yaXR5IEtleSBJZGVudGlmaWVyOiAKICAgICAgICAgICAgICAgIGtleWlkOkVDOjc0OkJFOkU4OkUzOjUxOkI0OkNBOkUyOjFFOjg0OkRDOkEwOjI4OjQ2OjAzOjlDOjMwOjk3OjdCCiAgICAgICAgICAgICAgICBEaXJOYW1lOi9DTj01Mi4yMDIuMjI2LjE3M0AxNDYyNTU4NDg2CiAgICAgICAgICAgICAgICBzZXJpYWw6QjA6RkY6Mjg6QTY6OEE6RUI6MEQ6RkYKCiAgICAgICAgICAgIFg1MDl2MyBFeHRlbmRlZCBLZXkgVXNhZ2U6IAogICAgICAgICAgICAgICAgVExTIFdlYiBDbGllbnQgQXV0aGVudGljYXRpb24KICAgICAgICAgICAgWDUwOXYzIEtleSBVc2FnZTogCiAgICAgICAgICAgICAgICBEaWdpdGFsIFNpZ25hdHVyZQogICAgU2lnbmF0dXJlIEFsZ29yaXRobTogc2hhMjU2V2l0aFJTQUVuY3J5cHRpb24KICAgICAgICAgNjk6ZGU6Y2Y6Y2M6ZjY6YTQ6YjM6MTY6MDQ6NzA6OWE6NDM6ZTc6ZGQ6Mzg6MmQ6OTc6MzU6CiAgICAgICAgIDhhOjhkOjA5OjcxOjRkOjIyOjVkOmY5OjcxOjAxOmYwOjJiOjVhOmIzOjgzOmY5OjgzOmEzOgogICAgICAgICA1Yjo3ODoxNDo0MDo2NTpmNDo3Njo1MDphNjpmMjo0YzpjZjphZjo3YTo1NDpkMTo5Yjo3ODoKICAgICAgICAgNTk6YWI6ODI6YzM6MGI6YWE6ZGY6ODU6YTE6YzA6ZDc6Zjk6YjM6NjM6Mzk6OWI6ZmU6ZTQ6CiAgICAgICAgIDFhOjNiOmJhOjBlOjNmOjQ1OmQ5OmVkOmRhOmU1OjdjOjVlOmZiOjI0OjQwOjUzOmM4OjYwOgogICAgICAgICBkYzpkNjozMzphNTo5NDowZjo2MzowZDo4MzpmMjpiYzo3ZjoyYzphODphYTpjODowMToxOToKICAgICAgICAgY2I6ODE6Yjk6NGU6YmM6Mzg6MmI6NGM6Mzg6OWU6OGM6YTk6ZTQ6NDI6ODE6MGI6YTc6Y2Y6CiAgICAgICAgIDJmOmQ2OmRmOjk2OjU5OmYyOjk2OjI2OmNiOmRmOjcxOjNhOjFmOjkxOjM3OjA4OmY4Ojk5OgogICAgICAgICAyZTpkZjplYTo5NjpmNzpmODo0YjpjOTo2MTplZjo2NzphMDo5ZDoxZjozODo4MDowODozZToKICAgICAgICAgNjI6ODU6NGE6NTg6OWM6ZTE6ZTI6NDM6N2Y6NWY6Yzk6MDA6ZjM6MGE6OTM6MjU6N2M6MTc6CiAgICAgICAgIGI5OjI3Ojc0OmQ2OmMxOmM5OmRhOjJmOjI0OmNiOjQ0OmY3OjY1OmEzOmQxOmI0OjVmOmE3OgogICAgICAgICBjYjoyNTo3ZjpmNzo1Mjo0Yzo3Mjo2NjpmNzphMDozMTpmYzpiMTo2NzpkMTo5MzoxMDpmNjoKICAgICAgICAgOTg6MGE6NmQ6NjE6OTI6ZTg6NTc6MDc6MWE6N2I6NTY6YjI6ZDM6ZmI6YWU6MDI6YjI6MzI6CiAgICAgICAgIDJmOmYxOjAxOjY3OmI2OjFkOmVlOjkyOjI0OmMwOmE1OmZjOjYwOjBlOmI5OjQ5OjNjOjExOgogICAgICAgICAzNToxNzo5NTpmZgotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJRFZ6Q0NBaitnQXdJQkFnSUJBakFOQmdrcWhraUc5dzBCQVFzRkFEQWtNU0l3SUFZRFZRUURGQmsxTWk0eQpNREl1TWpJMkxqRTNNMEF4TkRZeU5UVTRORGcyTUI0WERURTJNRFV3TmpFNE1UUTBObG9YRFRJMk1EVXdOREU0Ck1UUTBObG93RWpFUU1BNEdBMVVFQXhNSGEzVmlaV3hsZERDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVAKQURDQ0FRb0NnZ0VCQU5JMWFFMHZjSC9uNUw5U3NHR3U4dStxV0lnRWFxK3lhZ2s2RDIyeWs3UDZDbGJaZktNTgpSSURoNXhHSUI2UTZ4SkMxb21LRXhjK202aThuRzFlcnJvUE9qRHEyZmc0R2pVa0RicTE2MUt1NmllU29MakR1CmZ4OTdIS205Y3Bpc1Y3ZEd0dHBheUtacCtGYVJkMGpQS3V4Z24xRkpvd1JtNDllR2ttVkgyWS9yNlFscUdDY1EKZXBvZjBCaVFtZXdERzhHT3F5VkFQLzY3V0dhUkVISG5RemhpazhCek45K0pkck45OW1FeG9NeFk2TXFyR0paTQo1L2RnMVB2TURNUnNENE1QZHhXbHllaEtKcEl5czJPdVFOWFdqNTZzdTNZb3IyUUpHYzZZUC8welZEWEJBQ0h1ClFRL2RaSzhNSW5rZ1laQ2Vrdld0UkQ2ZjNSMVpMa0l5UWtNQ0F3RUFBYU9CcFRDQm9qQUpCZ05WSFJNRUFqQUEKTUIwR0ExVWREZ1FXQkJUangrM1NsMmEzYmhFd21tekxHMzBjcW1XQmxqQlVCZ05WSFNNRVRUQkxnQlRzZEw3bwo0MUcweXVJZWhOeWdLRVlEbkRDWGU2RW9wQ1l3SkRFaU1DQUdBMVVFQXhRWk5USXVNakF5TGpJeU5pNHhOek5BCk1UUTJNalUxT0RRNE5vSUpBTEQvS0thSzZ3My9NQk1HQTFVZEpRUU1NQW9HQ0NzR0FRVUZCd01DTUFzR0ExVWQKRHdRRUF3SUhnREFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBYWQ3UHpQYWtzeFlFY0pwRDU5MDRMWmMxaW8wSgpjVTBpWGZseEFmQXJXck9EK1lPalczZ1VRR1gwZGxDbThrelByM3BVMFp0NFdhdUN3d3VxMzRXaHdOZjVzMk01Cm0vN2tHanU2RGo5RjJlM2E1WHhlK3lSQVU4aGczTll6cFpRUFl3MkQ4cngvTEtpcXlBRVp5NEc1VHJ3NEswdzQKbm95cDVFS0JDNmZQTDliZmxsbnlsaWJMMzNFNkg1RTNDUGlaTHQvcWx2ZjRTOGxoNzJlZ25SODRnQWcrWW9WSwpXSnpoNGtOL1g4a0E4d3FUSlh3WHVTZDAxc0hKMmk4a3kwVDNaYVBSdEYrbnl5Vi85MUpNY21iM29ESDhzV2ZSCmt4RDJtQXB0WVpMb1Z3Y2FlMWF5MC91dUFySXlML0VCWjdZZDdwSWt3S1g4WUE2NVNUd1JOUmVWL3c9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=='
KUBELET_KEY: 'LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRRFNOV2hOTDNCLzUrUy8KVXJCaHJ2THZxbGlJQkdxdnNtb0pPZzl0c3BPeitncFcyWHlqRFVTQTRlY1JpQWVrT3NTUXRhSmloTVhQcHVvdgpKeHRYcTY2RHpvdzZ0bjRPQm8xSkEyNnRldFNydW9ua3FDNHc3bjhmZXh5cHZYS1lyRmUzUnJiYVdzaW1hZmhXCmtYZEl6eXJzWUo5UlNhTUVadVBYaHBKbFI5bVA2K2tKYWhnbkVIcWFIOUFZa0puc0F4dkJqcXNsUUQvK3UxaG0Ka1JCeDUwTTRZcFBBY3pmZmlYYXpmZlpoTWFETVdPaktxeGlXVE9mM1lOVDd6QXpFYkErREQzY1ZwY25vU2lhUwpNck5qcmtEVjFvK2VyTHQyS0s5a0NSbk9tRC85TTFRMXdRQWg3a0VQM1dTdkRDSjVJR0dRbnBMMXJVUStuOTBkCldTNUNNa0pEQWdNQkFBRUNnZ0VBWkpMaEFHeitLblJNNGEweWJzcEJ1YUdMRWlqcTBuMU9kbk90QmhNMjBCbUYKOE4vRjNrMXV4U3RRWHZieWtRVDlIeStJTGhMUWdmV2Vma2o3c0FxWVNMLytIK2xJam5WY0M5NzBpVlFIaE5LUApQek9vUmdrV0VYM1p6T3l6YzVDaHR6TENNZDdWdWFsaUJDazlKVHpaa0piNkl1NVViTHE5c0ZUV25sYXVKVWtnCkRYd0hjWUhTNTM4U05ncEhqZktqZ3JnenFVV1NMdy81aHB5SFlCaVhXdklnY1hRdkwxUkVuY0Y2RmFHYXMvS1oKa2JxdHVCOEMxOXUweklFLzg3ZHdBMEhSN21uSldhNGJtNTBwalVGU0xPdlN5cFhONkNTc0NidXBNYnR5TkloaApiSlE3UVZxVGFGejNURS9qRWtid0RNK3dxZmpuY1RPNjBIeG51WWJjNFFLQmdRRHB1UUMzMVR2TEJpekZWb2JYCmJmdDczOW1kSXlJOTBUaHl4dTlxZ0tUL3dxRGdMa0plRG5XV1dlTHBkUzFlTXNPRVAzQTRyTHloK25rQWNIbjIKWVlQWlBOa2NycjRaKzZaOXhvN29UTjlSb3RLdDcyWmNmSlZQT0dva3RXWVIxcFRHaDB6WU53b1FaRnlwZ0hPRQp2UlF5c3AvVmkwZmRCaThTSzZOSkNVcHQzUUtCZ1FEbVBxVTZ0L2ptUEQra1ZmaXF2NmNrcDZVaGx5LzVkQUFxClVERTV6eW83ZG5hSGpYTk5seTVMNkFvV0d4eGtJRkVQdXZrS3pSU2I0cm54QlFSMUhma0FBalI3WWtVZkdBdVEKYTB0eUxTZXpqSU1tTGd1ZDIxakJKSWxwazB2UkUvTnlQZGFOc25vMkVTbG9sTnBESUREZTdLQ3N6K29rcmpXVgp4c1hNT1VhK253S0JnUUNQbTBqQnE1ZE5xOEdlandmVEhwVERERXZkclZUQXZ1ajhQUmVtVE4wVStUVjRDWFJsCjdtUjV1VWtmUVF4Yk1MM0phR0Uvc1lORjAyeTl4RjVyOEliZTEvQmZHMDliRDdEQTMxdTNpR1ErK05pU1h1SjYKT1dKVWhzbFJQTlEyYWE2SVBXSU9CK043SnU5NGhxQjBFdWx5TFNiZ1F2QW84ai9CM21ZNTNpZUpVUUtCZ1FEUwpkVmJRK3BNLzJMaVB2YW5rWWZVbE16eGxITzVVUmExVkFDSk81a2VEUFFDUlhVR1ZIZWpLcDVwNHBHVnFQSVA4Ckxmc3czVTdHUXhPVjlQRWpJTGVYUTJ5M2o1Y0JHaGlQOVJOc2xVdmgra0Z6Sjhta2pIaHZhN2RUVXJtTnJuL3IKNEF4N1R6WVlyODA2OUQwaCtJM1RaMVpqUUZXVkc4eU5VTGxDdU9RcW53S0JnRS9wSkFCT3h4QWlJOUxHL0R6aAovWkt3bC9CeFJQYnJ3VXpaZFc1NDMrMUpPS1AvVzRXTWZwL2RHeXRzV2hHNWhyOXlzMDJPSmUyVWVvVzU1cmFBCkxXVkJrZXlITk9peFVvSU5YbytFUmpDcVppNXVFeHNSQ3J0SDIySW8vcU5WZ2tvd3Rhb1pPRVYydkR3UkdhdGoKVUM5ZFFqb3FJTkxqTDJRUmViTG42RndZCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K'
NETWORK_PROVIDER: 'none'
HAIRPIN_MODE: ''
OPENCONTRAIL_TAG: 'R2.20'
OPENCONTRAIL_KUBERNETES_TAG: 'master'
OPENCONTRAIL_PUBLIC_SUBNET: '10.1.0.0/16'
E2E_STORAGE_TEST_ENVIRONMENT: 'false'
KUBE_IMAGE_TAG: ''
KUBE_DOCKER_REGISTRY: ''
KUBE_ADDON_REGISTRY: ''
MULTIZONE: ''
NON_MASQUERADE_CIDR: '10.0.0.0/8'
KUBERNETES_MASTER: 'false'
ZONE: 'us-east-1a'
EXTRA_DOCKER_OPTS: ''
AUTO_UPGRADE: 'true'
DOCKER_STORAGE: 'aufs'
API_SERVERS: '172.20.0.9'
__EOF_KUBE_ENV_YAML

wget -O bootstrap https://s3.amazonaws.com/kubernetes-staging-1f8388770186e82b07ada78a3d29b1db/devel/bootstrap-script
chmod +x bootstrap
mkdir -p /etc/kubernetes/manifests
mv kube_env.yaml /etc/kubernetes
mv bootstrap /etc/kubernetes/
cat > /etc/kubernetes/manifests/kube-registry-proxy.yaml << EOF_PROXY
apiVersion: v1
kind: Pod
metadata:
  name: kube-registry-proxy
  namespace: kube-system
spec:
  containers:
  - name: kube-registry-proxy
    image: gcr.io/google_containers/kube-registry-proxy:0.3
    resources:
      limits:
        cpu: 100m
        memory: 50Mi
    env:
    - name: REGISTRY_HOST
      value: kube-registry.kube-system.svc.cluster.local
    - name: REGISTRY_PORT
      value: "5000"
    - name: FORWARD_PORT
      value: "5000"
    ports:
    - name: registry
      containerPort: 5000
      hostPort: 5000
EOF_PROXY

cat > /tmp/install-custom.sh << EOF_CUSTOM
#!/bin/bash
curl -s https://s3.amazonaws.com/download.draios.com/DRAIOS-GPG-KEY.public | apt-key add -
curl -s -o /etc/apt/sources.list.d/draios.list http://download.draios.com/stable/deb/draios.list
apt-get update && apt-get -y install sysdig
rm -f /tmp/install-custom.sh
EOF_CUSTOM
chmod +x /tmp/install-custom.sh
/tmp/install-custom.sh
cat > /etc/rc.local << EOF_RC_LOCAL
#!/bin/sh -e
/etc/kubernetes/bootstrap
exit 0
EOF_RC_LOCAL
/etc/kubernetes/bootstrap
